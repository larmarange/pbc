<?php
// This script and data application were generated by AppGini 5.82
// Download AppGini for free from https://bigprof.com/appgini/download/

	/* Configuration */
	/*************************************/

		$pcConfig = array(
			'conventions' => array(
				'porteur' => array(
					'parent-table' => 'personnes',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Conventions <span class="hidden child-label-conventions child-field-caption">(Porteur)</span>',
					'auto-close' => false,
					'table-icon' => 'resources/table_icons/035-legal-document.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Nom', 2 => 'Statut', 3 => 'Bailleur(s)', 4 => 'Porteur', 5 => 'Chef de Projet', 6 => 'Date r&#233;ponse', 7 => 'Demand&#233;', 8 => 'D&#233;but', 9 => 'Fin', 10 => 'Dur&#233;e (mois)', 12 => 'Accord&#233; hors FG', 13 => 'Frais de Gestion', 14 => 'Total Accord&#233;', 15 => 'Vers&#233;', 16 => 'Reste &#224; Verser', 17 => 'Vers&#233; hors FG', 18 => 'Ouvert', 19 => 'Reste &#224; Ouvrir', 20 => 'Non Liquid&#233;', 21 => 'Liquid&#233;', 22 => 'Utilis&#233; (L+NL)', 23 => 'Disponible (O-U)', 24 => 'Reste &#224; Engager', 25 => 'Salaires restant &#224; verser', 26 => 'Reste &#224; D&#233;penser', 27 => 'U/O (%)', 28 => 'U/V (%)', 29 => 'U/A (%, hors FG)', 30 => 'Budget non ventil&#233;', 31 => 'D&#233;penses non ventil&#233;es'),
					'display-field-names' => array(1 => 'nom', 2 => 'statut', 3 => 'bailleur', 4 => 'porteur', 5 => 'chef_projet', 6 => 'date_reponse', 7 => 'demande', 8 => 'date_debut', 9 => 'date_fin', 10 => 'duree', 12 => 'accorde_hfg', 13 => 'frais_gestion', 14 => 'accorde', 15 => 'verse', 16 => 'reste_verser', 17 => 'verse_hfg', 18 => 'ouvert', 19 => 'reste_ouvrir', 20 => 'non_liquide', 21 => 'liquide', 22 => 'utilise', 23 => 'disponible', 24 => 'reste_engager', 25 => 'reservation_salaire', 26 => 'reste_depenser', 27 => 'prop_uo', 28 => 'prop_uv', 29 => 'prop_ua', 30 => 'budget_nv', 31 => 'depenses_nv'),
					'sortable-fields' => array(0 => '`conventions`.`id`', 1 => 2, 2 => 3, 3 => 4, 4 => '`personnes1`.`nom`', 5 => '`personnes2`.`nom`', 6 => '`conventions`.`date_reponse`', 7 => '`conventions`.`demande`', 8 => '`conventions`.`date_debut`', 9 => '`conventions`.`date_fin`', 10 => '`conventions`.`duree`', 11 => 12, 12 => '`conventions`.`accorde_hfg`', 13 => '`conventions`.`frais_gestion`', 14 => '`conventions`.`accorde`', 15 => '`conventions`.`verse`', 16 => '`conventions`.`reste_verser`', 17 => '`conventions`.`verse_hfg`', 18 => '`conventions`.`ouvert`', 19 => '`conventions`.`reste_ouvrir`', 20 => '`conventions`.`non_liquide`', 21 => '`conventions`.`liquide`', 22 => '`conventions`.`utilise`', 23 => '`conventions`.`disponible`', 24 => '`conventions`.`reste_engager`', 25 => '`conventions`.`reservation_salaire`', 26 => '`conventions`.`reste_depenser`', 27 => '`conventions`.`prop_uo`', 28 => '`conventions`.`prop_uv`', 29 => '`conventions`.`prop_ua`', 30 => '`conventions`.`budget_nv`', 31 => '`conventions`.`depenses_nv`'),
					'records-per-page' => 50,
					'default-sort-by' => 9,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-conventions',
					'template-printable' => 'children-conventions-printable',
					'query' => "SELECT `conventions`.`id` as 'id', `conventions`.`nom` as 'nom', `conventions`.`statut` as 'statut', `conventions`.`bailleur` as 'bailleur', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'porteur', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'chef_projet', if(`conventions`.`date_reponse`,date_format(`conventions`.`date_reponse`,'%d/%m/%Y'),'') as 'date_reponse', CONCAT('$', FORMAT(`conventions`.`demande`, 2)) as 'demande', if(`conventions`.`date_debut`,date_format(`conventions`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`conventions`.`date_fin`,date_format(`conventions`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `conventions`.`duree` as 'duree', `conventions`.`notes` as 'notes', CONCAT('$', FORMAT(`conventions`.`accorde_hfg`, 2)) as 'accorde_hfg', CONCAT('$', FORMAT(`conventions`.`frais_gestion`, 2)) as 'frais_gestion', CONCAT('$', FORMAT(`conventions`.`accorde`, 2)) as 'accorde', CONCAT('$', FORMAT(`conventions`.`verse`, 2)) as 'verse', CONCAT('$', FORMAT(`conventions`.`reste_verser`, 2)) as 'reste_verser', CONCAT('$', FORMAT(`conventions`.`verse_hfg`, 2)) as 'verse_hfg', CONCAT('$', FORMAT(`conventions`.`ouvert`, 2)) as 'ouvert', CONCAT('$', FORMAT(`conventions`.`reste_ouvrir`, 2)) as 'reste_ouvrir', CONCAT('$', FORMAT(`conventions`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`conventions`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`conventions`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`conventions`.`disponible`, 2)) as 'disponible', CONCAT('$', FORMAT(`conventions`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`conventions`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`conventions`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`conventions`.`prop_uo`, 2)) as 'prop_uo', CONCAT('&euro;', FORMAT(`conventions`.`prop_uv`, 2)) as 'prop_uv', CONCAT('&euro;', FORMAT(`conventions`.`prop_ua`, 2)) as 'prop_ua', CONCAT('$', FORMAT(`conventions`.`budget_nv`, 2)) as 'budget_nv', CONCAT('$', FORMAT(`conventions`.`depenses_nv`, 2)) as 'depenses_nv' FROM `conventions` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`conventions`.`porteur` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`conventions`.`chef_projet` "
				),
				'chef_projet' => array(
					'parent-table' => 'personnes',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Conventions <span class="hidden child-label-conventions child-field-caption">(Chef de Projet)</span>',
					'auto-close' => false,
					'table-icon' => 'resources/table_icons/035-legal-document.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Nom', 2 => 'Statut', 3 => 'Bailleur(s)', 4 => 'Porteur', 5 => 'Chef de Projet', 6 => 'Date r&#233;ponse', 7 => 'Demand&#233;', 8 => 'D&#233;but', 9 => 'Fin', 10 => 'Dur&#233;e (mois)', 12 => 'Accord&#233; hors FG', 13 => 'Frais de Gestion', 14 => 'Total Accord&#233;', 15 => 'Vers&#233;', 16 => 'Reste &#224; Verser', 17 => 'Vers&#233; hors FG', 18 => 'Ouvert', 19 => 'Reste &#224; Ouvrir', 20 => 'Non Liquid&#233;', 21 => 'Liquid&#233;', 22 => 'Utilis&#233; (L+NL)', 23 => 'Disponible (O-U)', 24 => 'Reste &#224; Engager', 25 => 'Salaires restant &#224; verser', 26 => 'Reste &#224; D&#233;penser', 27 => 'U/O (%)', 28 => 'U/V (%)', 29 => 'U/A (%, hors FG)', 30 => 'Budget non ventil&#233;', 31 => 'D&#233;penses non ventil&#233;es'),
					'display-field-names' => array(1 => 'nom', 2 => 'statut', 3 => 'bailleur', 4 => 'porteur', 5 => 'chef_projet', 6 => 'date_reponse', 7 => 'demande', 8 => 'date_debut', 9 => 'date_fin', 10 => 'duree', 12 => 'accorde_hfg', 13 => 'frais_gestion', 14 => 'accorde', 15 => 'verse', 16 => 'reste_verser', 17 => 'verse_hfg', 18 => 'ouvert', 19 => 'reste_ouvrir', 20 => 'non_liquide', 21 => 'liquide', 22 => 'utilise', 23 => 'disponible', 24 => 'reste_engager', 25 => 'reservation_salaire', 26 => 'reste_depenser', 27 => 'prop_uo', 28 => 'prop_uv', 29 => 'prop_ua', 30 => 'budget_nv', 31 => 'depenses_nv'),
					'sortable-fields' => array(0 => '`conventions`.`id`', 1 => 2, 2 => 3, 3 => 4, 4 => '`personnes1`.`nom`', 5 => '`personnes2`.`nom`', 6 => '`conventions`.`date_reponse`', 7 => '`conventions`.`demande`', 8 => '`conventions`.`date_debut`', 9 => '`conventions`.`date_fin`', 10 => '`conventions`.`duree`', 11 => 12, 12 => '`conventions`.`accorde_hfg`', 13 => '`conventions`.`frais_gestion`', 14 => '`conventions`.`accorde`', 15 => '`conventions`.`verse`', 16 => '`conventions`.`reste_verser`', 17 => '`conventions`.`verse_hfg`', 18 => '`conventions`.`ouvert`', 19 => '`conventions`.`reste_ouvrir`', 20 => '`conventions`.`non_liquide`', 21 => '`conventions`.`liquide`', 22 => '`conventions`.`utilise`', 23 => '`conventions`.`disponible`', 24 => '`conventions`.`reste_engager`', 25 => '`conventions`.`reservation_salaire`', 26 => '`conventions`.`reste_depenser`', 27 => '`conventions`.`prop_uo`', 28 => '`conventions`.`prop_uv`', 29 => '`conventions`.`prop_ua`', 30 => '`conventions`.`budget_nv`', 31 => '`conventions`.`depenses_nv`'),
					'records-per-page' => 50,
					'default-sort-by' => 9,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-conventions',
					'template-printable' => 'children-conventions-printable',
					'query' => "SELECT `conventions`.`id` as 'id', `conventions`.`nom` as 'nom', `conventions`.`statut` as 'statut', `conventions`.`bailleur` as 'bailleur', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'porteur', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'chef_projet', if(`conventions`.`date_reponse`,date_format(`conventions`.`date_reponse`,'%d/%m/%Y'),'') as 'date_reponse', CONCAT('$', FORMAT(`conventions`.`demande`, 2)) as 'demande', if(`conventions`.`date_debut`,date_format(`conventions`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`conventions`.`date_fin`,date_format(`conventions`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `conventions`.`duree` as 'duree', `conventions`.`notes` as 'notes', CONCAT('$', FORMAT(`conventions`.`accorde_hfg`, 2)) as 'accorde_hfg', CONCAT('$', FORMAT(`conventions`.`frais_gestion`, 2)) as 'frais_gestion', CONCAT('$', FORMAT(`conventions`.`accorde`, 2)) as 'accorde', CONCAT('$', FORMAT(`conventions`.`verse`, 2)) as 'verse', CONCAT('$', FORMAT(`conventions`.`reste_verser`, 2)) as 'reste_verser', CONCAT('$', FORMAT(`conventions`.`verse_hfg`, 2)) as 'verse_hfg', CONCAT('$', FORMAT(`conventions`.`ouvert`, 2)) as 'ouvert', CONCAT('$', FORMAT(`conventions`.`reste_ouvrir`, 2)) as 'reste_ouvrir', CONCAT('$', FORMAT(`conventions`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`conventions`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`conventions`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`conventions`.`disponible`, 2)) as 'disponible', CONCAT('$', FORMAT(`conventions`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`conventions`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`conventions`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`conventions`.`prop_uo`, 2)) as 'prop_uo', CONCAT('&euro;', FORMAT(`conventions`.`prop_uv`, 2)) as 'prop_uv', CONCAT('&euro;', FORMAT(`conventions`.`prop_ua`, 2)) as 'prop_ua', CONCAT('$', FORMAT(`conventions`.`budget_nv`, 2)) as 'budget_nv', CONCAT('$', FORMAT(`conventions`.`depenses_nv`, 2)) as 'depenses_nv' FROM `conventions` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`conventions`.`porteur` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`conventions`.`chef_projet` "
				),
			),
			'budgets' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Lignes budg&#233;taires <span class="hidden child-label-budgets child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/006-business.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Type', 3 => 'Pr&#233;cision', 4 => 'Accord&#233;', 5 => 'Notes', 6 => 'Vers&#233;', 7 => 'Reste &#224; Verser', 8 => 'Ouvert', 9 => 'Reste &#224; Ouvrir', 10 => 'Non Liquid&#233;', 11 => 'Liquid&#233;', 12 => 'Utilis&#233;', 13 => 'Disponible', 14 => 'Reste &#224; Engager', 15 => 'Salaires restant &#224; verser', 16 => 'Reste &#224; D&#233;penser', 17 => 'U/O (%)', 18 => 'U/V (%)', 19 => 'U/A (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'type', 3 => 'precision', 4 => 'accorde', 5 => 'notes', 6 => 'verse', 7 => 'reste_verser', 8 => 'ouvert', 9 => 'reste_ouvrir', 10 => 'non_liquide', 11 => 'liquide', 12 => 'utilise', 13 => 'disponible', 14 => 'reste_engager', 15 => 'reservation_salaire', 16 => 'reste_depenser', 17 => 'prop_uo', 18 => 'prop_uv', 19 => 'prop_ua'),
					'sortable-fields' => array(0 => '`budgets`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`budgets`.`accorde`', 5 => 6, 6 => '`budgets`.`verse`', 7 => '`budgets`.`reste_verser`', 8 => '`budgets`.`ouvert`', 9 => '`budgets`.`reste_ouvrir`', 10 => '`budgets`.`non_liquide`', 11 => '`budgets`.`liquide`', 12 => '`budgets`.`utilise`', 13 => '`budgets`.`disponible`', 14 => '`budgets`.`reste_engager`', 15 => '`budgets`.`reservation_salaire`', 16 => '`budgets`.`reste_depenser`', 17 => '`budgets`.`prop_uo`', 18 => '`budgets`.`prop_uv`', 19 => '`budgets`.`prop_ua`'),
					'records-per-page' => 50,
					'default-sort-by' => 2,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-budgets',
					'template-printable' => 'children-budgets-printable',
					'query' => "SELECT `budgets`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`), '') as 'type', `budgets`.`precision` as 'precision', CONCAT('$', FORMAT(`budgets`.`accorde`, 2)) as 'accorde', if(CHAR_LENGTH(`budgets`.`notes`)>80, concat(left(`budgets`.`notes`,80),' ...'), `budgets`.`notes`) as 'notes', CONCAT('$', FORMAT(`budgets`.`verse`, 2)) as 'verse', CONCAT('$', FORMAT(`budgets`.`reste_verser`, 2)) as 'reste_verser', CONCAT('$', FORMAT(`budgets`.`ouvert`, 2)) as 'ouvert', CONCAT('$', FORMAT(`budgets`.`reste_ouvrir`, 2)) as 'reste_ouvrir', CONCAT('$', FORMAT(`budgets`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`budgets`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`budgets`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`budgets`.`disponible`, 2)) as 'disponible', CONCAT('$', FORMAT(`budgets`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`budgets`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`budgets`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`budgets`.`prop_uo`, 2)) as 'prop_uo', CONCAT('&euro;', FORMAT(`budgets`.`prop_uv`, 2)) as 'prop_uv', CONCAT('&euro;', FORMAT(`budgets`.`prop_ua`, 2)) as 'prop_ua' FROM `budgets` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`budgets`.`convention` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets`.`type` "
				),
			),
			'versements' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Versements (bailleur) <span class="hidden child-label-versements child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/009-cash.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Date', 4 => 'Intitul&#233;', 5 => 'Montant', 6 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'date', 4 => 'intitule', 5 => 'montant', 6 => 'notes'),
					'sortable-fields' => array(0 => '`versements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`versements`.`date`', 4 => 5, 5 => '`versements`.`montant`', 6 => 7),
					'records-per-page' => 50,
					'default-sort-by' => 3,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-versements',
					'template-printable' => 'children-versements-printable',
					'query' => "SELECT `versements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', if(`versements`.`date`,date_format(`versements`.`date`,'%d/%m/%Y'),'') as 'date', `versements`.`intitule` as 'intitule', CONCAT('$', FORMAT(`versements`.`montant`, 2)) as 'montant', if(CHAR_LENGTH(`versements`.`notes`)>80, concat(left(`versements`.`notes`,80),' ...'), `versements`.`notes`) as 'notes' FROM `versements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`versements`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`versements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` "
				),
				'ligne_budgetaire' => array(
					'parent-table' => 'budgets',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Versements (bailleur) <span class="hidden child-label-versements child-field-caption">(Ligne Budg&#233;taire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/009-cash.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Date', 4 => 'Intitul&#233;', 5 => 'Montant', 6 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'date', 4 => 'intitule', 5 => 'montant', 6 => 'notes'),
					'sortable-fields' => array(0 => '`versements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`versements`.`date`', 4 => 5, 5 => '`versements`.`montant`', 6 => 7),
					'records-per-page' => 50,
					'default-sort-by' => 3,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-versements',
					'template-printable' => 'children-versements-printable',
					'query' => "SELECT `versements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', if(`versements`.`date`,date_format(`versements`.`date`,'%d/%m/%Y'),'') as 'date', `versements`.`intitule` as 'intitule', CONCAT('$', FORMAT(`versements`.`montant`, 2)) as 'montant', if(CHAR_LENGTH(`versements`.`notes`)>80, concat(left(`versements`.`notes`,80),' ...'), `versements`.`notes`) as 'notes' FROM `versements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`versements`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`versements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` "
				),
			),
			'lignes_credits' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Lignes de Cr&#233;dits <span class="hidden child-label-lignes_credits child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/044-prince2.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Intitul&#233; / CFI', 4 => 'Exercice', 5 => 'Notes', 6 => 'Ouvert', 7 => 'Non Liquid&#233;', 8 => 'Liquid&#233;', 9 => 'Utilis&#233;', 10 => 'Disponible', 11 => 'U/O (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'intitule', 4 => 'exercice', 5 => 'notes', 6 => 'ouvert', 7 => 'non_liquide', 8 => 'liquide', 9 => 'utilise', 10 => 'disponible', 11 => 'prop_uo'),
					'sortable-fields' => array(0 => '`lignes_credits`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => '`lignes_credits`.`ouvert`', 7 => '`lignes_credits`.`non_liquide`', 8 => '`lignes_credits`.`liquide`', 9 => '`lignes_credits`.`utilise`', 10 => '`lignes_credits`.`disponible`', 11 => '`lignes_credits`.`prop_uo`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-lignes_credits',
					'template-printable' => 'children-lignes_credits-printable',
					'query' => "SELECT `lignes_credits`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', `lignes_credits`.`intitule` as 'intitule', `lignes_credits`.`exercice` as 'exercice', if(CHAR_LENGTH(`lignes_credits`.`notes`)>80, concat(left(`lignes_credits`.`notes`,80),' ...'), `lignes_credits`.`notes`) as 'notes', CONCAT('$', FORMAT(`lignes_credits`.`ouvert`, 2)) as 'ouvert', CONCAT('$', FORMAT(`lignes_credits`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`lignes_credits`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`lignes_credits`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`lignes_credits`.`disponible`, 2)) as 'disponible', CONCAT('&euro;', FORMAT(`lignes_credits`.`prop_uo`, 2)) as 'prop_uo' FROM `lignes_credits` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`lignes_credits`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`lignes_credits`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` "
				),
				'ligne_budgetaire' => array(
					'parent-table' => 'budgets',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Lignes de Cr&#233;dits <span class="hidden child-label-lignes_credits child-field-caption">(Ligne Budg&#233;taire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/044-prince2.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Intitul&#233; / CFI', 4 => 'Exercice', 5 => 'Notes', 6 => 'Ouvert', 7 => 'Non Liquid&#233;', 8 => 'Liquid&#233;', 9 => 'Utilis&#233;', 10 => 'Disponible', 11 => 'U/O (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'intitule', 4 => 'exercice', 5 => 'notes', 6 => 'ouvert', 7 => 'non_liquide', 8 => 'liquide', 9 => 'utilise', 10 => 'disponible', 11 => 'prop_uo'),
					'sortable-fields' => array(0 => '`lignes_credits`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => 5, 5 => 6, 6 => '`lignes_credits`.`ouvert`', 7 => '`lignes_credits`.`non_liquide`', 8 => '`lignes_credits`.`liquide`', 9 => '`lignes_credits`.`utilise`', 10 => '`lignes_credits`.`disponible`', 11 => '`lignes_credits`.`prop_uo`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-lignes_credits',
					'template-printable' => 'children-lignes_credits-printable',
					'query' => "SELECT `lignes_credits`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', `lignes_credits`.`intitule` as 'intitule', `lignes_credits`.`exercice` as 'exercice', if(CHAR_LENGTH(`lignes_credits`.`notes`)>80, concat(left(`lignes_credits`.`notes`,80),' ...'), `lignes_credits`.`notes`) as 'notes', CONCAT('$', FORMAT(`lignes_credits`.`ouvert`, 2)) as 'ouvert', CONCAT('$', FORMAT(`lignes_credits`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`lignes_credits`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`lignes_credits`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`lignes_credits`.`disponible`, 2)) as 'disponible', CONCAT('&euro;', FORMAT(`lignes_credits`.`prop_uo`, 2)) as 'prop_uo' FROM `lignes_credits` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`lignes_credits`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`lignes_credits`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` "
				),
			),
			'credits' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Cr&#233;dits (ouverture) <span class="hidden child-label-credits child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/051-revenue.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'Montant', 7 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'montant', 7 => 'notes'),
					'sortable-fields' => array(0 => '`credits`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`credits`.`date`', 5 => 6, 6 => '`credits`.`montant`', 7 => 8),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-credits',
					'template-printable' => 'children-credits-printable',
					'query' => "SELECT `credits`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`credits`.`date`,date_format(`credits`.`date`,'%d/%m/%Y'),'') as 'date', `credits`.`intitule` as 'intitule', CONCAT('$', FORMAT(`credits`.`montant`, 2)) as 'montant', if(CHAR_LENGTH(`credits`.`notes`)>80, concat(left(`credits`.`notes`,80),' ...'), `credits`.`notes`) as 'notes' FROM `credits` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`credits`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`credits`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`credits`.`ligne_credit` "
				),
				'ligne_budgetaire' => array(
					'parent-table' => 'budgets',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Cr&#233;dits (ouverture) <span class="hidden child-label-credits child-field-caption">(Ligne Budg&#233;taire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/051-revenue.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'Montant', 7 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'montant', 7 => 'notes'),
					'sortable-fields' => array(0 => '`credits`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`credits`.`date`', 5 => 6, 6 => '`credits`.`montant`', 7 => 8),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-credits',
					'template-printable' => 'children-credits-printable',
					'query' => "SELECT `credits`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`credits`.`date`,date_format(`credits`.`date`,'%d/%m/%Y'),'') as 'date', `credits`.`intitule` as 'intitule', CONCAT('$', FORMAT(`credits`.`montant`, 2)) as 'montant', if(CHAR_LENGTH(`credits`.`notes`)>80, concat(left(`credits`.`notes`,80),' ...'), `credits`.`notes`) as 'notes' FROM `credits` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`credits`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`credits`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`credits`.`ligne_credit` "
				),
				'ligne_credit' => array(
					'parent-table' => 'lignes_credits',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Cr&#233;dits (ouverture) <span class="hidden child-label-credits child-field-caption">(Ligne de cr&#233;dit (CFI) - Exercice)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/051-revenue.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'Montant', 7 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'montant', 7 => 'notes'),
					'sortable-fields' => array(0 => '`credits`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`credits`.`date`', 5 => 6, 6 => '`credits`.`montant`', 7 => 8),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-credits',
					'template-printable' => 'children-credits-printable',
					'query' => "SELECT `credits`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`credits`.`date`,date_format(`credits`.`date`,'%d/%m/%Y'),'') as 'date', `credits`.`intitule` as 'intitule', CONCAT('$', FORMAT(`credits`.`montant`, 2)) as 'montant', if(CHAR_LENGTH(`credits`.`notes`)>80, concat(left(`credits`.`notes`,80),' ...'), `credits`.`notes`) as 'notes' FROM `credits` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`credits`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`credits`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`credits`.`ligne_credit` "
				),
			),
			'rubriques' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Rubriques de Ventilation <span class="hidden child-label-rubriques child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/032-archives.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Intitul&#233;', 3 => 'Notes', 4 => 'Pr&#233;visionnel', 5 => 'Non Liquid&#233;', 6 => 'Liquid&#233;', 7 => 'Utilis&#233;', 8 => 'Reste &#224; Engager', 9 => 'Salaires restant &#224; verser', 10 => 'Reste &#224; D&#233;penser', 11 => 'U/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'intitule', 3 => 'notes', 4 => 'accorde', 5 => 'non_liquide', 6 => 'liquide', 7 => 'utilise', 8 => 'reste_engager', 9 => 'reservation_salaire', 10 => 'reste_depenser', 11 => 'prop_ua'),
					'sortable-fields' => array(0 => '`rubriques`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`rubriques`.`accorde`', 5 => '`rubriques`.`non_liquide`', 6 => '`rubriques`.`liquide`', 7 => '`rubriques`.`utilise`', 8 => '`rubriques`.`reste_engager`', 9 => '`rubriques`.`reservation_salaire`', 10 => '`rubriques`.`reste_depenser`', 11 => '`rubriques`.`prop_ua`'),
					'records-per-page' => 50,
					'default-sort-by' => 2,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-rubriques',
					'template-printable' => 'children-rubriques-printable',
					'query' => "SELECT `rubriques`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `rubriques`.`intitule` as 'intitule', if(CHAR_LENGTH(`rubriques`.`notes`)>80, concat(left(`rubriques`.`notes`,80),' ...'), `rubriques`.`notes`) as 'notes', CONCAT('$', FORMAT(`rubriques`.`accorde`, 2)) as 'accorde', CONCAT('$', FORMAT(`rubriques`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`rubriques`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`rubriques`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`rubriques`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`rubriques`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`rubriques`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`rubriques`.`prop_ua`, 2)) as 'prop_ua' FROM `rubriques` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`rubriques`.`convention` "
				),
			),
			'ventilation' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Ventilation Budg&#233;taire <span class="hidden child-label-ventilation child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/024-tasks.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Rubrique de Ventilation', 3 => 'Intitul&#233;', 4 => 'Notes', 5 => 'Pr&#233;visionnel', 6 => 'Non Liquid&#233;', 7 => 'Liquid&#233;', 8 => 'Utilis&#233;', 9 => 'Reste &#224; Engager', 10 => 'Salaires restant &#224; verser', 11 => 'Reste &#224; D&#233;penser', 12 => 'U/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'rubrique', 3 => 'intitule', 4 => 'notes', 5 => 'accorde', 6 => 'non_liquide', 7 => 'liquide', 8 => 'utilise', 9 => 'reste_engager', 10 => 'reservation_salaire', 11 => 'reste_depenser', 12 => 'prop_ua'),
					'sortable-fields' => array(0 => '`ventilation`.`id`', 1 => '`conventions1`.`nom`', 2 => '`rubriques1`.`intitule`', 3 => 4, 4 => 5, 5 => '`ventilation`.`accorde`', 6 => '`ventilation`.`non_liquide`', 7 => '`ventilation`.`liquide`', 8 => '`ventilation`.`utilise`', 9 => '`ventilation`.`reste_engager`', 10 => '`ventilation`.`reservation_salaire`', 11 => '`ventilation`.`reste_depenser`', 12 => '`ventilation`.`prop_ua`'),
					'records-per-page' => 50,
					'default-sort-by' => 2,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-ventilation',
					'template-printable' => 'children-ventilation-printable',
					'query' => "SELECT `ventilation`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`rubriques1`.`intitule`), CONCAT_WS('',   `rubriques1`.`intitule`), '') as 'rubrique', `ventilation`.`intitule` as 'intitule', if(CHAR_LENGTH(`ventilation`.`notes`)>80, concat(left(`ventilation`.`notes`,80),' ...'), `ventilation`.`notes`) as 'notes', CONCAT('$', FORMAT(`ventilation`.`accorde`, 2)) as 'accorde', CONCAT('$', FORMAT(`ventilation`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`ventilation`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`ventilation`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`ventilation`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`ventilation`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`ventilation`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`ventilation`.`prop_ua`, 2)) as 'prop_ua' FROM `ventilation` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`ventilation`.`convention` LEFT JOIN `rubriques` as rubriques1 ON `rubriques1`.`id`=`ventilation`.`rubrique` "
				),
				'rubrique' => array(
					'parent-table' => 'rubriques',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Ventilation Budg&#233;taire <span class="hidden child-label-ventilation child-field-caption">(Rubrique de Ventilation)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/024-tasks.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Rubrique de Ventilation', 3 => 'Intitul&#233;', 4 => 'Notes', 5 => 'Pr&#233;visionnel', 6 => 'Non Liquid&#233;', 7 => 'Liquid&#233;', 8 => 'Utilis&#233;', 9 => 'Reste &#224; Engager', 10 => 'Salaires restant &#224; verser', 11 => 'Reste &#224; D&#233;penser', 12 => 'U/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'rubrique', 3 => 'intitule', 4 => 'notes', 5 => 'accorde', 6 => 'non_liquide', 7 => 'liquide', 8 => 'utilise', 9 => 'reste_engager', 10 => 'reservation_salaire', 11 => 'reste_depenser', 12 => 'prop_ua'),
					'sortable-fields' => array(0 => '`ventilation`.`id`', 1 => '`conventions1`.`nom`', 2 => '`rubriques1`.`intitule`', 3 => 4, 4 => 5, 5 => '`ventilation`.`accorde`', 6 => '`ventilation`.`non_liquide`', 7 => '`ventilation`.`liquide`', 8 => '`ventilation`.`utilise`', 9 => '`ventilation`.`reste_engager`', 10 => '`ventilation`.`reservation_salaire`', 11 => '`ventilation`.`reste_depenser`', 12 => '`ventilation`.`prop_ua`'),
					'records-per-page' => 50,
					'default-sort-by' => 2,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-ventilation',
					'template-printable' => 'children-ventilation-printable',
					'query' => "SELECT `ventilation`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`rubriques1`.`intitule`), CONCAT_WS('',   `rubriques1`.`intitule`), '') as 'rubrique', `ventilation`.`intitule` as 'intitule', if(CHAR_LENGTH(`ventilation`.`notes`)>80, concat(left(`ventilation`.`notes`,80),' ...'), `ventilation`.`notes`) as 'notes', CONCAT('$', FORMAT(`ventilation`.`accorde`, 2)) as 'accorde', CONCAT('$', FORMAT(`ventilation`.`non_liquide`, 2)) as 'non_liquide', CONCAT('$', FORMAT(`ventilation`.`liquide`, 2)) as 'liquide', CONCAT('$', FORMAT(`ventilation`.`utilise`, 2)) as 'utilise', CONCAT('$', FORMAT(`ventilation`.`reste_engager`, 2)) as 'reste_engager', CONCAT('$', FORMAT(`ventilation`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('$', FORMAT(`ventilation`.`reste_depenser`, 2)) as 'reste_depenser', CONCAT('&euro;', FORMAT(`ventilation`.`prop_ua`, 2)) as 'prop_ua' FROM `ventilation` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`ventilation`.`convention` LEFT JOIN `rubriques` as rubriques1 ON `rubriques1`.`id`=`ventilation`.`rubrique` "
				),
			),
			'recrutements' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Recrutements <span class="hidden child-label-recrutements child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/067-human-resources-1.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Intitul&#233; du poste', 3 => 'B&#233;n&#233;ficiaire', 4 => 'D&#233;but', 5 => 'Fin', 6 => 'Dur&#233;e (mois)', 7 => 'Ligne budg&#233;taire', 8 => 'Ventilation Analytique', 9 => 'Notes', 10 => 'Co&#251;t total pr&#233;visionnel', 11 => 'D&#233;pens&#233;', 12 => 'Salaires restant &#224; verser', 13 => 'D/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'intitule', 3 => 'beneficiaire', 4 => 'date_debut', 5 => 'date_fin', 6 => 'duree', 7 => 'ligne_budgetaire', 8 => 'ventilation', 9 => 'notes', 10 => 'previsionnel', 11 => 'depense', 12 => 'reservation_salaire', 13 => 'prop_dp'),
					'sortable-fields' => array(0 => '`recrutements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`personnes1`.`nom`', 4 => '`recrutements`.`date_debut`', 5 => '`recrutements`.`date_fin`', 6 => '`recrutements`.`duree`', 7 => 8, 8 => '`ventilation1`.`intitule`', 9 => 10, 10 => '`recrutements`.`previsionnel`', 11 => '`recrutements`.`depense`', 12 => '`recrutements`.`reservation_salaire`', 13 => '`recrutements`.`prop_dp`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-recrutements',
					'template-printable' => 'children-recrutements-printable',
					'query' => "SELECT `recrutements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `recrutements`.`intitule` as 'intitule', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'beneficiaire', if(`recrutements`.`date_debut`,date_format(`recrutements`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`recrutements`.`date_fin`,date_format(`recrutements`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `recrutements`.`duree` as 'duree', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`recrutements`.`notes`)>80, concat(left(`recrutements`.`notes`,80),' ...'), `recrutements`.`notes`) as 'notes', CONCAT('$', FORMAT(`recrutements`.`previsionnel`, 2)) as 'previsionnel', CONCAT('$', FORMAT(`recrutements`.`depense`, 2)) as 'depense', CONCAT('$', FORMAT(`recrutements`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('&euro;', FORMAT(`recrutements`.`prop_dp`, 2)) as 'prop_dp' FROM `recrutements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`recrutements`.`convention` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements`.`beneficiaire` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`recrutements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`recrutements`.`ventilation` "
				),
				'beneficiaire' => array(
					'parent-table' => 'personnes',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Recrutements <span class="hidden child-label-recrutements child-field-caption">(B&#233;n&#233;ficiaire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/067-human-resources-1.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Intitul&#233; du poste', 3 => 'B&#233;n&#233;ficiaire', 4 => 'D&#233;but', 5 => 'Fin', 6 => 'Dur&#233;e (mois)', 7 => 'Ligne budg&#233;taire', 8 => 'Ventilation Analytique', 9 => 'Notes', 10 => 'Co&#251;t total pr&#233;visionnel', 11 => 'D&#233;pens&#233;', 12 => 'Salaires restant &#224; verser', 13 => 'D/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'intitule', 3 => 'beneficiaire', 4 => 'date_debut', 5 => 'date_fin', 6 => 'duree', 7 => 'ligne_budgetaire', 8 => 'ventilation', 9 => 'notes', 10 => 'previsionnel', 11 => 'depense', 12 => 'reservation_salaire', 13 => 'prop_dp'),
					'sortable-fields' => array(0 => '`recrutements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`personnes1`.`nom`', 4 => '`recrutements`.`date_debut`', 5 => '`recrutements`.`date_fin`', 6 => '`recrutements`.`duree`', 7 => 8, 8 => '`ventilation1`.`intitule`', 9 => 10, 10 => '`recrutements`.`previsionnel`', 11 => '`recrutements`.`depense`', 12 => '`recrutements`.`reservation_salaire`', 13 => '`recrutements`.`prop_dp`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-recrutements',
					'template-printable' => 'children-recrutements-printable',
					'query' => "SELECT `recrutements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `recrutements`.`intitule` as 'intitule', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'beneficiaire', if(`recrutements`.`date_debut`,date_format(`recrutements`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`recrutements`.`date_fin`,date_format(`recrutements`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `recrutements`.`duree` as 'duree', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`recrutements`.`notes`)>80, concat(left(`recrutements`.`notes`,80),' ...'), `recrutements`.`notes`) as 'notes', CONCAT('$', FORMAT(`recrutements`.`previsionnel`, 2)) as 'previsionnel', CONCAT('$', FORMAT(`recrutements`.`depense`, 2)) as 'depense', CONCAT('$', FORMAT(`recrutements`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('&euro;', FORMAT(`recrutements`.`prop_dp`, 2)) as 'prop_dp' FROM `recrutements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`recrutements`.`convention` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements`.`beneficiaire` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`recrutements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`recrutements`.`ventilation` "
				),
				'ligne_budgetaire' => array(
					'parent-table' => 'budgets',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Recrutements <span class="hidden child-label-recrutements child-field-caption">(Ligne budg&#233;taire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/067-human-resources-1.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Intitul&#233; du poste', 3 => 'B&#233;n&#233;ficiaire', 4 => 'D&#233;but', 5 => 'Fin', 6 => 'Dur&#233;e (mois)', 7 => 'Ligne budg&#233;taire', 8 => 'Ventilation Analytique', 9 => 'Notes', 10 => 'Co&#251;t total pr&#233;visionnel', 11 => 'D&#233;pens&#233;', 12 => 'Salaires restant &#224; verser', 13 => 'D/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'intitule', 3 => 'beneficiaire', 4 => 'date_debut', 5 => 'date_fin', 6 => 'duree', 7 => 'ligne_budgetaire', 8 => 'ventilation', 9 => 'notes', 10 => 'previsionnel', 11 => 'depense', 12 => 'reservation_salaire', 13 => 'prop_dp'),
					'sortable-fields' => array(0 => '`recrutements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`personnes1`.`nom`', 4 => '`recrutements`.`date_debut`', 5 => '`recrutements`.`date_fin`', 6 => '`recrutements`.`duree`', 7 => 8, 8 => '`ventilation1`.`intitule`', 9 => 10, 10 => '`recrutements`.`previsionnel`', 11 => '`recrutements`.`depense`', 12 => '`recrutements`.`reservation_salaire`', 13 => '`recrutements`.`prop_dp`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-recrutements',
					'template-printable' => 'children-recrutements-printable',
					'query' => "SELECT `recrutements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `recrutements`.`intitule` as 'intitule', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'beneficiaire', if(`recrutements`.`date_debut`,date_format(`recrutements`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`recrutements`.`date_fin`,date_format(`recrutements`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `recrutements`.`duree` as 'duree', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`recrutements`.`notes`)>80, concat(left(`recrutements`.`notes`,80),' ...'), `recrutements`.`notes`) as 'notes', CONCAT('$', FORMAT(`recrutements`.`previsionnel`, 2)) as 'previsionnel', CONCAT('$', FORMAT(`recrutements`.`depense`, 2)) as 'depense', CONCAT('$', FORMAT(`recrutements`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('&euro;', FORMAT(`recrutements`.`prop_dp`, 2)) as 'prop_dp' FROM `recrutements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`recrutements`.`convention` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements`.`beneficiaire` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`recrutements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`recrutements`.`ventilation` "
				),
				'ventilation' => array(
					'parent-table' => 'ventilation',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Recrutements <span class="hidden child-label-recrutements child-field-caption">(Ventilation Analytique)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/067-human-resources-1.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Intitul&#233; du poste', 3 => 'B&#233;n&#233;ficiaire', 4 => 'D&#233;but', 5 => 'Fin', 6 => 'Dur&#233;e (mois)', 7 => 'Ligne budg&#233;taire', 8 => 'Ventilation Analytique', 9 => 'Notes', 10 => 'Co&#251;t total pr&#233;visionnel', 11 => 'D&#233;pens&#233;', 12 => 'Salaires restant &#224; verser', 13 => 'D/P (%)'),
					'display-field-names' => array(1 => 'convention', 2 => 'intitule', 3 => 'beneficiaire', 4 => 'date_debut', 5 => 'date_fin', 6 => 'duree', 7 => 'ligne_budgetaire', 8 => 'ventilation', 9 => 'notes', 10 => 'previsionnel', 11 => 'depense', 12 => 'reservation_salaire', 13 => 'prop_dp'),
					'sortable-fields' => array(0 => '`recrutements`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => '`personnes1`.`nom`', 4 => '`recrutements`.`date_debut`', 5 => '`recrutements`.`date_fin`', 6 => '`recrutements`.`duree`', 7 => 8, 8 => '`ventilation1`.`intitule`', 9 => 10, 10 => '`recrutements`.`previsionnel`', 11 => '`recrutements`.`depense`', 12 => '`recrutements`.`reservation_salaire`', 13 => '`recrutements`.`prop_dp`'),
					'records-per-page' => 50,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-recrutements',
					'template-printable' => 'children-recrutements-printable',
					'query' => "SELECT `recrutements`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `recrutements`.`intitule` as 'intitule', IF(    CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `personnes1`.`nom`), '') as 'beneficiaire', if(`recrutements`.`date_debut`,date_format(`recrutements`.`date_debut`,'%d/%m/%Y'),'') as 'date_debut', if(`recrutements`.`date_fin`,date_format(`recrutements`.`date_fin`,'%d/%m/%Y'),'') as 'date_fin', `recrutements`.`duree` as 'duree', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`recrutements`.`notes`)>80, concat(left(`recrutements`.`notes`,80),' ...'), `recrutements`.`notes`) as 'notes', CONCAT('$', FORMAT(`recrutements`.`previsionnel`, 2)) as 'previsionnel', CONCAT('$', FORMAT(`recrutements`.`depense`, 2)) as 'depense', CONCAT('$', FORMAT(`recrutements`.`reservation_salaire`, 2)) as 'reservation_salaire', CONCAT('&euro;', FORMAT(`recrutements`.`prop_dp`, 2)) as 'prop_dp' FROM `recrutements` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`recrutements`.`convention` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements`.`beneficiaire` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`recrutements`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`recrutements`.`ventilation` "
				),
			),
			'depenses' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
				'ligne_budgetaire' => array(
					'parent-table' => 'budgets',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(Ligne Budg&#233;taire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
				'ligne_credit' => array(
					'parent-table' => 'lignes_credits',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(Ligne de cr&#233;dit (CFI) - Exercice)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
				'contrat' => array(
					'parent-table' => 'recrutements',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(Contrat (si salaire))</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
				'beneficiaire' => array(
					'parent-table' => 'personnes',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(B&#233;n&#233;ficiaire)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
				'ventilation' => array(
					'parent-table' => 'ventilation',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'D&#233;penses <span class="hidden child-label-depenses child-field-caption">(Ventilation Analytique)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/005-expenses.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Ligne Budg&#233;taire', 3 => 'Ligne de cr&#233;dit (CFI) - Exercice', 4 => 'Date', 5 => 'Intitul&#233;', 6 => 'R&#233;ference', 7 => 'Contrat (si salaire)', 8 => 'B&#233;n&#233;ficiaire', 9 => 'Montant', 10 => 'Liquid&#233;e ?', 11 => 'Ventilation Analytique', 12 => 'Notes', 13 => 'V&#233;rifi&#233;e ?'),
					'display-field-names' => array(1 => 'convention', 2 => 'ligne_budgetaire', 3 => 'ligne_credit', 4 => 'date', 5 => 'intitule', 6 => 'reference', 7 => 'contrat', 8 => 'beneficiaire', 9 => 'montant', 10 => 'liquidee', 11 => 'ventilation', 12 => 'notes', 13 => 'verifie'),
					'sortable-fields' => array(0 => '`depenses`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => '`depenses`.`date`', 5 => 6, 6 => 7, 7 => 8, 8 => '`personnes2`.`nom`', 9 => '`depenses`.`montant`', 10 => '`depenses`.`liquidee`', 11 => '`ventilation1`.`intitule`', 12 => 13, 13 => '`depenses`.`verifie`'),
					'records-per-page' => 50,
					'default-sort-by' => 4,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-depenses',
					'template-printable' => 'children-depenses-printable',
					'query' => "SELECT `depenses`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', IF(    CHAR_LENGTH(`types_ligne1`.`gestionnaire`) || CHAR_LENGTH(`types_ligne1`.`type`) || CHAR_LENGTH(`budgets1`.`precision`), CONCAT_WS('',   `types_ligne1`.`gestionnaire`, ' - ', `types_ligne1`.`type`, ' - ', `budgets1`.`precision`), '') as 'ligne_budgetaire', IF(    CHAR_LENGTH(`lignes_credits1`.`intitule`) || CHAR_LENGTH(`lignes_credits1`.`exercice`), CONCAT_WS('',   `lignes_credits1`.`intitule`, ' - ', `lignes_credits1`.`exercice`), '') as 'ligne_credit', if(`depenses`.`date`,date_format(`depenses`.`date`,'%d/%m/%Y'),'') as 'date', `depenses`.`intitule` as 'intitule', `depenses`.`reference` as 'reference', IF(    CHAR_LENGTH(`recrutements1`.`intitule`) || CHAR_LENGTH(`personnes1`.`nom`), CONCAT_WS('',   `recrutements1`.`intitule`, ' - ', `personnes1`.`nom`), '') as 'contrat', IF(    CHAR_LENGTH(`personnes2`.`nom`), CONCAT_WS('',   `personnes2`.`nom`), '') as 'beneficiaire', CONCAT('$', FORMAT(`depenses`.`montant`, 2)) as 'montant', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`liquidee`, 'check', 'unchecked'), '\"></i>') as 'liquidee', IF(    CHAR_LENGTH(`ventilation1`.`intitule`), CONCAT_WS('',   `ventilation1`.`intitule`), '') as 'ventilation', if(CHAR_LENGTH(`depenses`.`notes`)>80, concat(left(`depenses`.`notes`,80),' ...'), `depenses`.`notes`) as 'notes', concat('<i class=\"glyphicon glyphicon-', if(`depenses`.`verifie`, 'check', 'unchecked'), '\"></i>') as 'verifie' FROM `depenses` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`depenses`.`convention` LEFT JOIN `budgets` as budgets1 ON `budgets1`.`id`=`depenses`.`ligne_budgetaire` LEFT JOIN `types_ligne` as types_ligne1 ON `types_ligne1`.`id`=`budgets1`.`type` LEFT JOIN `lignes_credits` as lignes_credits1 ON `lignes_credits1`.`id`=`depenses`.`ligne_credit` LEFT JOIN `recrutements` as recrutements1 ON `recrutements1`.`id`=`depenses`.`contrat` LEFT JOIN `personnes` as personnes1 ON `personnes1`.`id`=`recrutements1`.`beneficiaire` LEFT JOIN `personnes` as personnes2 ON `personnes2`.`id`=`depenses`.`beneficiaire` LEFT JOIN `ventilation` as ventilation1 ON `ventilation1`.`id`=`depenses`.`ventilation` "
				),
			),
			'fichiers' => array(
				'convention' => array(
					'parent-table' => 'conventions',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Fichiers <span class="hidden child-label-fichiers child-field-caption">(Convention)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/025-exchange.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Convention', 2 => 'Titre', 3 => 'Fichier', 4 => 'Notes'),
					'display-field-names' => array(1 => 'convention', 2 => 'titre', 3 => 'fichier', 4 => 'notes'),
					'sortable-fields' => array(0 => '`fichiers`.`id`', 1 => '`conventions1`.`nom`', 2 => 3, 3 => 4, 4 => 5),
					'records-per-page' => 50,
					'default-sort-by' => 2,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-fichiers',
					'template-printable' => 'children-fichiers-printable',
					'query' => "SELECT `fichiers`.`id` as 'id', IF(    CHAR_LENGTH(`conventions1`.`nom`), CONCAT_WS('',   `conventions1`.`nom`), '') as 'convention', `fichiers`.`titre` as 'titre', `fichiers`.`fichier` as 'fichier', if(CHAR_LENGTH(`fichiers`.`notes`)>80, concat(left(`fichiers`.`notes`,80),' ...'), `fichiers`.`notes`) as 'notes' FROM `fichiers` LEFT JOIN `conventions` as conventions1 ON `conventions1`.`id`=`fichiers`.`convention` "
				),
			),
			'personnes' => array(
			),
			'types_ligne' => array(
			),
		);

	/*************************************/
	/* End of configuration */


	$currDir = dirname(__FILE__);
	include("{$currDir}/defaultLang.php");
	include("{$currDir}/language.php");
	include("{$currDir}/lib.php");
	@header('Content-Type: text/html; charset=' . datalist_db_encoding);

	handle_maintenance();

	/**
	* dynamic configuration based on current user's permissions
	* $userPCConfig array is populated only with parent tables where the user has access to
	* at least one child table
	*/
	$userPCConfig = array();
	foreach($pcConfig as $pcChildTable => $ChildrenLookups) {
		$permChild = getTablePermissions($pcChildTable);
		if($permChild[2]) { // user can view records of the child table, so proceed to check children lookups
			foreach($ChildrenLookups as $ChildLookupField => $ChildConfig) {
				$permParent = getTablePermissions($ChildConfig['parent-table']);
				if($permParent[2]) { // user can view records of parent table
					$userPCConfig[$pcChildTable][$ChildLookupField] = $pcConfig[$pcChildTable][$ChildLookupField];
					// show add new only if configured above AND the user has insert permission
					if($permChild[1] && $pcConfig[$pcChildTable][$ChildLookupField]['display-add-new']) {
						$userPCConfig[$pcChildTable][$ChildLookupField]['display-add-new'] = true;
					}else{
						$userPCConfig[$pcChildTable][$ChildLookupField]['display-add-new'] = false;
					}
				}
			}
		}
	}

	/* Receive, UTF-convert, and validate parameters */
	$ParentTable = $_REQUEST['ParentTable']; // needed only with operation=show-children, will be validated in the processing code
	$ChildTable = $_REQUEST['ChildTable'];
		if(!in_array($ChildTable, array_keys($userPCConfig))) {
			/* defaults to first child table in config array if not provided */
			$ChildTable = current(array_keys($userPCConfig));
		}
		if(!$ChildTable) { die('<!-- No tables accessible to current user -->'); }
	$SelectedID = strip_tags($_REQUEST['SelectedID']);
	$ChildLookupField = $_REQUEST['ChildLookupField'];
		if(!in_array($ChildLookupField, array_keys($userPCConfig[$ChildTable]))) {
			/* defaults to first lookup in current child config array if not provided */
			$ChildLookupField = current(array_keys($userPCConfig[$ChildTable]));
		}
	$Page = intval($_REQUEST['Page']);
		if($Page < 1) {
			$Page = 1;
		}
	$SortBy = ($_REQUEST['SortBy'] != '' ? abs(intval($_REQUEST['SortBy'])) : false);
		if(!in_array($SortBy, array_keys($userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields']), true)) {
			$SortBy = $userPCConfig[$ChildTable][$ChildLookupField]['default-sort-by'];
		}
	$SortDirection = strtolower($_REQUEST['SortDirection']);
		if(!in_array($SortDirection, array('asc', 'desc'))) {
			$SortDirection = $userPCConfig[$ChildTable][$ChildLookupField]['default-sort-direction'];
		}
	$Operation = strtolower($_REQUEST['Operation']);
		if(!in_array($Operation, array('get-records', 'show-children', 'get-records-printable', 'show-children-printable'))) {
			$Operation = 'get-records';
		}

	/* process requested operation */
	switch($Operation) {
		/************************************************/
		case 'show-children':
			/* populate HTML and JS content with children tabs */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] == $ParentTable) {
						$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\" />" : '');
						$tabLabels .= sprintf('<li class="child-tab-label child-table-%s lookup-field-%s %s"><a href="#panel_%s-%s" id="tab_%s-%s" data-toggle="tab">%s%s</a></li>' . "\n\t\t\t\t\t", $ChildTable, $ChildLookupField, ($tabLabels ? '' : 'active'), $ChildTable, $ChildLookupField, $ChildTable, $ChildLookupField, $TableIcon, $childConfig['tab-label']);
						$tabPanels .= sprintf('<div id="panel_%s-%s" class="tab-pane%s"><img src="loading.gif" align="top" />%s</div>' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, ($tabPanels ? '' : ' active'), $Translation['Loading ...']);
						$tabLoaders .= sprintf('post("parent-children.php", { ChildTable: "%s", ChildLookupField: "%s", SelectedID: "%s", Page: 1, SortBy: "", SortDirection: "", Operation: "get-records" }, "panel_%s-%s");' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, addslashes($SelectedID), $ChildTable, $ChildLookupField);
					}
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs">
				<ul class="nav nav-tabs">
					<?php echo $tabLabels; ?>
				</ul>
				<span id="pc-loading"></span>
			</div>
			<div class="tab-content"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>

					/* show child field caption on tab title in case the same child table appears more than once */
					$j('.child-field-caption').each(function() {
						var clss = $j(this).attr('class').split(/\s+/).reduce(function(rc, cc) {
							return (cc.match(/child-label-.*/) ? '.' + cc : rc);
						}, '');

						// if class occurs more than once, remove .hidden
						if($j(clss).length > 1) $j(clss).removeClass('hidden');
					})
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'show-children-printable':
			/* populate HTML and JS content with children buttons */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] == $ParentTable) {
						$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\" />" : '');
						$tabLabels .= sprintf('<button type="button" class="btn btn-default" data-target="#panel_%s-%s" id="tab_%s-%s" data-toggle="collapse">%s %s</button>' . "\n\t\t\t\t\t", $ChildTable, $ChildLookupField, $ChildTable, $ChildLookupField, $TableIcon, $childConfig['tab-label']);
						$tabPanels .= sprintf('<div id="panel_%s-%s" class="collapse"><img src="loading.gif" align="top" />%s</div>' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, $Translation['Loading ...']);
						$tabLoaders .= sprintf('post("parent-children.php", { ChildTable: "%s", ChildLookupField: "%s", SelectedID: "%s", Page: 1, SortBy: "", SortDirection: "", Operation: "get-records-printable" }, "panel_%s-%s");' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, addslashes($SelectedID), $ChildTable, $ChildLookupField);
					}
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs" class="hidden-print">
				<div class="btn-group btn-group-lg">
					<?php echo $tabLabels; ?>
				</div>
				<span id="pc-loading"></span>
			</div>
			<div class="vspacer-lg"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'get-records-printable':
		default: /* default is 'get-records' */

			if($Operation == 'get-records-printable') {
				$userPCConfig[$ChildTable][$ChildLookupField]['records-per-page'] = 2000;
			}

			// build the user permissions limiter
			$permissionsWhere = $permissionsJoin = '';
			$permChild = getTablePermissions($ChildTable);
			if($permChild[2] == 1) { // user can view only his own records
				$permissionsWhere = "`$ChildTable`.`{$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND LCASE(`membership_userrecords`.`memberID`)='".getLoggedMemberID()."'";
			}elseif($permChild[2] == 2) { // user can view only his group's records
				$permissionsWhere = "`$ChildTable`.`{$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND `membership_userrecords`.`groupID`='".getLoggedGroupID()."'";
			}elseif($permChild[2] == 3) { // user can view all records
				/* that's the only case remaining ... no need to modify the query in this case */
			}
			$permissionsJoin = ($permissionsWhere ? ", `membership_userrecords`" : '');

			// build the count query
			$forcedWhere = $userPCConfig[$ChildTable][$ChildLookupField]['forced-where'];
			$query =
				preg_replace('/^select .* from /i', 'SELECT count(1) FROM ', $userPCConfig[$ChildTable][$ChildLookupField]['query']) .
				$permissionsJoin . " WHERE " .
				($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
				($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
				"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'";
			$totalMatches = sqlValue($query);

			// make sure $Page is <= max pages
			$maxPage = ceil($totalMatches / $userPCConfig[$ChildTable][$ChildLookupField]['records-per-page']);
			if($Page > $maxPage) { $Page = $maxPage; }

			// initiate output data array
			$data = array(
				'config' => $userPCConfig[$ChildTable][$ChildLookupField],
				'parameters' => array(
					'ChildTable' => $ChildTable,
					'ChildLookupField' => $ChildLookupField,
					'SelectedID' => $SelectedID,
					'Page' => $Page,
					'SortBy' => $SortBy,
					'SortDirection' => $SortDirection,
					'Operation' => $Operation
				),
				'records' => array(),
				'totalMatches' => $totalMatches
			);

			// build the data query
			if($totalMatches) { // if we have at least one record, proceed with fetching data
				$startRecord = $userPCConfig[$ChildTable][$ChildLookupField]['records-per-page'] * ($Page - 1);
				$data['query'] =
					$userPCConfig[$ChildTable][$ChildLookupField]['query'] .
					$permissionsJoin . " WHERE " .
					($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
					($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
					"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'" .
					($SortBy !== false && $userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields'][$SortBy] ? " ORDER BY {$userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields'][$SortBy]} $SortDirection" : '') .
					" LIMIT $startRecord, {$userPCConfig[$ChildTable][$ChildLookupField]['records-per-page']}";
				$res = sql($data['query'], $eo);
				while($row = db_fetch_row($res)) {
					$data['records'][$row[$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key-index']]] = $row;
				}
			}else{ // if no matching records
				$startRecord = 0;
			}

			if($Operation == 'get-records-printable') {
				$response = loadView($userPCConfig[$ChildTable][$ChildLookupField]['template-printable'], $data);
			}else{
				$response = loadView($userPCConfig[$ChildTable][$ChildLookupField]['template'], $data);
			}

			// change name space to ensure uniqueness
			$uniqueNameSpace = $ChildTable.ucfirst($ChildLookupField).'GetRecords';
			echo str_replace("{$ChildTable}GetChildrenRecordsList", $uniqueNameSpace, $response);
		/************************************************/
	}
